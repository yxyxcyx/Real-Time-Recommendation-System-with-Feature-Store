# Real-Time Recommendation System Configuration
system:
  name: "RealTimeRecSys"
  version: "1.0.0"
  environment: "development"  # development, staging, production
  debug: true
  random_seed: 42

# Feature Store Configuration
feature_store:
  provider: "feast"
  project_name: "recsys_features"
  registry_path: "feature_store/registry/registry.db"
  online_store:
    type: "redis"
    connection_string: "redis://localhost:6379"
  offline_store:
    type: "file"
    path: "feature_store/data/"
  
# Model Configuration
model:
  two_tower:
    embedding_dim: 128
    user_tower:
      hidden_layers: [512, 256, 128]
      dropout_rate: 0.2
      activation: "relu"
    item_tower:
      hidden_layers: [512, 256, 128]
      dropout_rate: 0.2
      activation: "relu"
    temperature: 0.05
    negative_sampling_ratio: 4
    
  ranking:
    model_type: "xgboost"  # xgboost, lightgbm, deepfm
    xgboost:
      n_estimators: 100
      max_depth: 8
      learning_rate: 0.1
      objective: "binary:logistic"
    deepfm:
      embedding_dim: 10
      hidden_units: [256, 128, 64]
      dropout_rate: 0.2
      
# Retrieval Configuration
retrieval:
  index_type: "faiss"  # faiss, milvus, annoy
  faiss:
    index_factory: "IVF1024,Flat"
    nprobe: 20
    metric: "cosine"
  top_k: 100
  update_interval_seconds: 300
  
# Serving Configuration
serving:
  api:
    host: "0.0.0.0"
    port: 8000
    workers: 4
    cors_origins: ["*"]
  batch_size: 32
  cache:
    enabled: true
    ttl_seconds: 300
    backend: "redis"
  shadow_deployment:
    enabled: true
    traffic_percentage: 5
    comparison_metrics: ["ctr", "engagement_time", "conversion_rate"]
    
# Streaming Configuration
streaming:
  kafka:
    bootstrap_servers: "localhost:9092"
    topics:
      user_events: "user-events"
      item_updates: "item-updates"
      feature_updates: "feature-updates"
    consumer_group: "recsys-consumer"
    auto_offset_reset: "latest"
  window_sizes:
    - 5_minutes
    - 1_hour
    - 24_hours
    
# Monitoring Configuration
monitoring:
  mlflow:
    tracking_uri: "http://localhost:5000"
    experiment_name: "recsys_experiments"
  prometheus:
    port: 9090
    metrics_path: "/metrics"
  logging:
    level: "INFO"
    format: "json"
    output_file: "logs/recsys.log"
  alerts:
    latency_threshold_ms: 100
    error_rate_threshold: 0.01
    
# Data Configuration
data:
  raw_data_path: "data/raw/"
  processed_data_path: "data/processed/"
  embeddings_path: "data/embeddings/"
  batch_size: 1024
  validation_split: 0.2
  test_split: 0.1
  
# Training Configuration
training:
  epochs: 50
  learning_rate: 0.001
  optimizer: "adam"
  scheduler:
    type: "cosine"
    warmup_steps: 1000
  early_stopping:
    patience: 5
    min_delta: 0.001
  checkpoint:
    save_best_only: true
    save_freq: 5
    
# A/B Testing Configuration
ab_testing:
  enabled: true
  default_variant: "control"
  variants:
    control:
      model_version: "v1.0"
      traffic_percentage: 95
    treatment:
      model_version: "v1.1"
      traffic_percentage: 5
  metrics:
    primary: "ctr"
    secondary: ["engagement_time", "conversion_rate", "revenue_per_user"]
